from pydantic.networks import import_email_validator
import pytest
import io


def create_file(data: str) -> io.BytesIO:

    file_like = io.BytesIO()
    file_like.write(data.encode())
    file_like.seek(0)

    return file_like


@pytest.fixture()
def valid_profile_csv():
    """Valid CSV profile data

    Header: [time, profile_1, profile_2, ..., profile_k]
        Can have any names as long as the first column is the time column
        Can have K profiles where K > 1

        time column format: 'HH:MM:SS'.
            Can be any values but must be at 30 minute intervals
            Must have 12 hours of data 24 data points
    """

    csv_data = (
        "Time, profile_1, profile_2, profile_3\n"
        "00:00:00, 0.1, 1.2, 0.3\n"
        "00:30:00, 1.1, 1.2, 0.3\n"
        "01:00:00, 12.1, 1.2, 0.3\n"
        "01:30:00, 0.1, 1.2, 0.3\n"
        "02:00:00, 0.1, 1.2, 0.3\n"
        "02:30:00, 23.1, 1.2, 0.3\n"
        "03:00:00, 0.3, 1.2, 0.3\n"
        "03:30:00, 0.1, 1.2, 0.3\n"
        "04:00:00, 0.1, 1.2, 0.3\n"
        "04:30:00, 0.1, 1.2, 0.3\n"
        "05:00:00, 0.1, 1.2, 0.3\n"
        "05:30:00, 0.1, 1.2, 0.3\n"
        "06:00:00, 0.1, 1.2, 0.3\n"
        "06:30:00, 0.1, 1.2, 0.3\n"
        "07:00:00, 0.1, 1.2, 0.3\n"
        "07:30:00, 0.1, 1.2, 0.3\n"
        "08:00:00, 0.1, 1.2, 0.3\n"
        "08:30:00, 0.1, 1.2, 0.3\n"
        "09:00:00, 0.1, 1.2, 0.3\n"
        "09:30:00, 0.1, 1.2, 0.3\n"
        "10:00:00, 0.1, 1.2, 0.3\n"
        "10:30:00, 0.1, 1.2, 0.3\n"
        "11:00:00, 0.1, 1.2, 0.3\n"
        "11:30:00, 10.2, 1.2, 11.2\n"
        "12:00:00, 0.1, 1.2, 0.3\n"
        "12:30:00, 1.1, 1.2, 0.3\n"
        "13:00:00, 12.1, 1.2, 0.3\n"
        "13:30:00, 0.1, 1.2, 0.3\n"
        "14:00:00, 0.1, 1.2, 0.3\n"
        "14:30:00, 23.1, 1.2, 0.3\n"
        "15:00:00, 0.3, 1.2, 0.3\n"
        "15:30:00, 0.1, 1.2, 0.3\n"
        "16:00:00, 0.1, 1.2, 0.3\n"
        "16:30:00, 0.1, 1.2, 0.3\n"
        "17:00:00, 0.1, 1.2, 0.3\n"
        "17:30:00, 0.1, 1.2, 0.3\n"
        "18:00:00, 0.1, 1.2, 0.3\n"
        "18:30:00, 0.1, 1.2, 0.3\n"
        "19:00:00, 0.1, 1.2, 0.3\n"
        "19:30:00, 0.1, 1.2, 0.3\n"
        "20:00:00, 0.1, 1.2, 0.3\n"
        "20:30:00, 0.1, 1.2, 0.3\n"
        "21:00:00, 0.1, 1.2, 0.3\n"
        "21:30:00, 0.1, 1.2, 0.3\n"
        "22:00:00, 0.1, 1.2, 0.3\n"
        "22:30:00, 0.1, 1.2, 0.3\n"
        "23:00:00, 0.1, 1.2, 0.3\n"
        "23:30:00, 10.2, 1.2, 11.2"
    )

    return create_file(csv_data)


@pytest.fixture()
def invalid_profile_csv_too_long():
    """Valid CSV profile data

    Header: [time, profile_1, profile_2, ..., profile_k]
        Can have any names as long as the first column is the time column
        Can have K profiles where K > 1

        time column format: 'HH:MM:SS'.
            Can be any values but must be at 30 minute intervals
            Must have 12 hours of data 24 data points
    """

    csv_data = (
        "Time, profile_1, profile_2, profile_3\n"
        "00:00:00, 0.1, 1.2, 0.3\n"
        "00:30:00, 1.1, 1.2, 0.3\n"
        "01:00:00, 12.1, 1.2, 0.3\n"
        "01:30:00, 0.1, 1.2, 0.3\n"
        "02:00:00, 0.1, 1.2, 0.3\n"
        "02:30:00, 23.1, 1.2, 0.3\n"
        "03:00:00, 0.3, 1.2, 0.3\n"
        "03:30:00, 0.1, 1.2, 0.3\n"
        "04:00:00, 0.1, 1.2, 0.3\n"
        "04:30:00, 0.1, 1.2, 0.3\n"
        "05:00:00, 0.1, 1.2, 0.3\n"
        "05:30:00, 0.1, 1.2, 0.3\n"
        "06:00:00, 0.1, 1.2, 0.3\n"
        "06:30:00, 0.1, 1.2, 0.3\n"
        "07:00:00, 0.1, 1.2, 0.3\n"
        "07:30:00, 0.1, 1.2, 0.3\n"
        "08:00:00, 0.1, 1.2, 0.3\n"
        "08:30:00, 0.1, 1.2, 0.3\n"
        "09:00:00, 0.1, 1.2, 0.3\n"
        "09:30:00, 0.1, 1.2, 0.3\n"
        "10:00:00, 0.1, 1.2, 0.3\n"
        "10:30:00, 0.1, 1.2, 0.3\n"
        "11:00:00, 0.1, 1.2, 0.3\n"
        "11:30:00, 10.2, 1.2, 11.2\n"
        "12:00:00, 0.1, 1.2, 0.3\n"
        "12:30:00, 1.1, 1.2, 0.3\n"
        "13:00:00, 12.1, 1.2, 0.3\n"
        "13:30:00, 0.1, 1.2, 0.3\n"
        "14:00:00, 0.1, 1.2, 0.3\n"
        "14:30:00, 23.1, 1.2, 0.3\n"
        "15:00:00, 0.3, 1.2, 0.3\n"
        "15:30:00, 0.1, 1.2, 0.3\n"
        "16:00:00, 0.1, 1.2, 0.3\n"
        "16:30:00, 0.1, 1.2, 0.3\n"
        "17:00:00, 0.1, 1.2, 0.3\n"
        "17:30:00, 0.1, 1.2, 0.3\n"
        "18:00:00, 0.1, 1.2, 0.3\n"
        "18:30:00, 0.1, 1.2, 0.3\n"
        "19:00:00, 0.1, 1.2, 0.3\n"
        "19:30:00, 0.1, 1.2, 0.3\n"
        "20:00:00, 0.1, 1.2, 0.3\n"
        "20:30:00, 0.1, 1.2, 0.3\n"
        "21:00:00, 0.1, 1.2, 0.3\n"
        "21:30:00, 0.1, 1.2, 0.3\n"
        "22:00:00, 0.1, 1.2, 0.3\n"
        "22:30:00, 0.1, 1.2, 0.3\n"
        "23:00:00, 0.1, 1.2, 0.3\n"
        "23:30:00, 10.2, 1.2, 11.2\n"
        "24:00:00, 10.2, 1.2, 11.2"
    )

    return create_file(csv_data)


@pytest.fixture()
def invalid_profile_csv_too_short():
    """Valid CSV profile data

    Header: [time, profile_1, profile_2, ..., profile_k]
        Can have any names as long as the first column is the time column
        Can have K profiles where K > 1

        time column format: 'HH:MM:SS'.
            Can be any values but must be at 30 minute intervals
            Must have 12 hours of data 24 data points
    """

    csv_data = (
        "Time, profile_1, profile_2, profile_3\n"
        "00:00:00, 0.1, 1.2, 0.3\n"
        "00:30:00, 1.1, 1.2, 0.3"
    )

    return create_file(csv_data)


@pytest.fixture()
def invalid_profile_wrong_time():
    """Valid CSV profile data

    Header: [time, profile_1, profile_2, ..., profile_k]
        Can have any names as long as the first column is the time column
        Can have K profiles where K > 1

        time column format: 'HH:MM:SS'.
            Can be any values but must be at 30 minute intervals
            Must have 12 hours of data 24 data points
    """

    csv_data = (
        "Time, profile_1, profile_2, profile_3\n"
        "00:00:00, 0.1, 1.2, 0.3\n"
        "01:30:00, 1.1, 1.2, 0.3\n"
        "01:00:00, 12.1, 1.2, 0.3\n"
        "01:30:00, 0.1, 1.2, 0.3\n"
        "02:00:00, 0.1, 1.2, 0.3\n"
        "02:30:00, 23.1, 1.2, 0.3\n"
        "03:00:00, 0.3, 1.2, 0.3\n"
        "03:30:00, 0.1, 1.2, 0.3\n"
        "04:00:00, 0.1, 1.2, 0.3\n"
        "04:30:00, 0.1, 1.2, 0.3\n"
        "05:00:00, 0.1, 1.2, 0.3\n"
        "05:30:00, 0.1, 1.2, 0.3\n"
        "06:00:00, 0.1, 1.2, 0.3\n"
        "06:30:00, 0.1, 1.2, 0.3\n"
        "07:00:00, 0.1, 1.2, 0.3\n"
        "07:30:00, 0.1, 1.2, 0.3\n"
        "08:00:00, 0.1, 1.2, 0.3\n"
        "08:30:00, 0.1, 1.2, 0.3\n"
        "09:00:00, 0.1, 1.2, 0.3\n"
        "09:30:00, 0.1, 1.2, 0.3\n"
        "10:00:00, 0.1, 1.2, 0.3\n"
        "10:30:00, 0.1, 1.2, 0.3\n"
        "11:00:00, 0.1, 1.2, 0.3\n"
        "11:30:00, 10.2, 1.2, 11.2\n"
        "12:00:00, 0.1, 1.2, 0.3\n"
        "12:30:00, 1.1, 1.2, 0.3\n"
        "13:00:00, 12.1, 1.2, 0.3\n"
        "13:30:00, 0.1, 1.2, 0.3\n"
        "14:00:00, 0.1, 1.2, 0.3\n"
        "14:30:00, 23.1, 1.2, 0.3\n"
        "15:00:00, 0.3, 1.2, 0.3\n"
        "15:30:00, 0.1, 1.2, 0.3\n"
        "16:00:00, 0.1, 1.2, 0.3\n"
        "16:30:00, 0.1, 1.2, 0.3\n"
        "17:00:00, 0.1, 1.2, 0.3\n"
        "17:30:00, 0.1, 1.2, 0.3\n"
        "18:00:00, 0.1, 1.2, 0.3\n"
        "18:30:00, 0.1, 1.2, 0.3\n"
        "19:00:00, 0.1, 1.2, 0.3\n"
        "19:30:00, 0.1, 1.2, 0.3\n"
        "20:00:00, 0.1, 1.2, 0.3\n"
        "20:30:00, 0.1, 1.2, 0.3\n"
        "21:00:00, 0.1, 1.2, 0.3\n"
        "21:30:00, 0.1, 1.2, 0.3\n"
        "22:00:00, 0.1, 1.2, 0.3\n"
        "22:30:00, 0.1, 1.2, 0.3\n"
        "23:00:00, 0.1, 1.2, 0.3\n"
        "23:30:00, 10.2, 1.2, 11.2"
    )

    return create_file(csv_data)


@pytest.fixture()
def invalid_profile_csv_offset():
    """Valid CSV profile data

    Header: [time, profile_1, profile_2, ..., profile_k]
        Can have any names as long as the first column is the time column
        Can have K profiles where K > 1

        time column format: 'HH:MM:SS'.
            Can be any values but must be at 30 minute intervals
            Must have 12 hours of data 24 data points
    """

    csv_data = (
        "Time, profile_1, profile_2, profile_3\n"
        "01:00:00, 12.1, 1.2, 0.3\n"
        "01:30:00, 0.1, 1.2, 0.3\n"
        "02:00:00, 0.1, 1.2, 0.3\n"
        "02:30:00, 23.1, 1.2, 0.3\n"
        "03:00:00, 0.3, 1.2, 0.3\n"
        "03:30:00, 0.1, 1.2, 0.3\n"
        "04:00:00, 0.1, 1.2, 0.3\n"
        "04:30:00, 0.1, 1.2, 0.3\n"
        "05:00:00, 0.1, 1.2, 0.3\n"
        "05:30:00, 0.1, 1.2, 0.3\n"
        "06:00:00, 0.1, 1.2, 0.3\n"
        "06:30:00, 0.1, 1.2, 0.3\n"
        "07:00:00, 0.1, 1.2, 0.3\n"
        "07:30:00, 0.1, 1.2, 0.3\n"
        "08:00:00, 0.1, 1.2, 0.3\n"
        "08:30:00, 0.1, 1.2, 0.3\n"
        "09:00:00, 0.1, 1.2, 0.3\n"
        "09:30:00, 0.1, 1.2, 0.3\n"
        "10:00:00, 0.1, 1.2, 0.3\n"
        "10:30:00, 0.1, 1.2, 0.3\n"
        "11:00:00, 0.1, 1.2, 0.3\n"
        "11:30:00, 10.2, 1.2, 11.2\n"
        "12:00:00, 0.1, 1.2, 0.3\n"
        "12:30:00, 1.1, 1.2, 0.3\n"
        "13:00:00, 12.1, 1.2, 0.3\n"
        "13:30:00, 0.1, 1.2, 0.3\n"
        "14:00:00, 0.1, 1.2, 0.3\n"
        "14:30:00, 23.1, 1.2, 0.3\n"
        "15:00:00, 0.3, 1.2, 0.3\n"
        "15:30:00, 0.1, 1.2, 0.3\n"
        "16:00:00, 0.1, 1.2, 0.3\n"
        "16:30:00, 0.1, 1.2, 0.3\n"
        "17:00:00, 0.1, 1.2, 0.3\n"
        "17:30:00, 0.1, 1.2, 0.3\n"
        "18:00:00, 0.1, 1.2, 0.3\n"
        "18:30:00, 0.1, 1.2, 0.3\n"
        "19:00:00, 0.1, 1.2, 0.3\n"
        "19:30:00, 0.1, 1.2, 0.3\n"
        "20:00:00, 0.1, 1.2, 0.3\n"
        "20:30:00, 0.1, 1.2, 0.3\n"
        "21:00:00, 0.1, 1.2, 0.3\n"
        "21:30:00, 0.1, 1.2, 0.3\n"
        "22:00:00, 0.1, 1.2, 0.3\n"
        "22:30:00, 0.1, 1.2, 0.3\n"
        "23:00:00, 0.1, 1.2, 0.3\n"
        "23:30:00, 10.2, 1.2, 11.2\n"
        "24:30:00, 10.2, 1.2, 11.2\n"
        "24:30:00, 10.2, 1.2, 11.2"
    )

    return create_file(csv_data)


@pytest.fixture()
def invalid_profile_csv_not_float():
    """Valid CSV profile data

    Header: [time, profile_1, profile_2, ..., profile_k]
        Can have any names as long as the first column is the time column
        Can have K profiles where K > 1

        time column format: 'HH:MM:SS'.
            Can be any values but must be at 30 minute intervals
            Must have 12 hours of data 24 data points
    """

    csv_data = (
        "Time, profile_1, profile_2, profile_3\n"
        "00:00:00, 0.1, 1.2, 0.3\n"
        "00:30:00, 1.1, 1.2, 0.3\n"
        "01:00:00, 12.1, 1.2, 0.3\n"
        "01:30:00, 0.1, 1.2, 0.3\n"
        "02:00:00, 0.1, 1.2, 0.3\n"
        "02:30:00, 23.1, 1.2, 0.3\n"
        "03:00:00, 0.3, 1.2, 0.3\n"
        "03:30:00, 0.1, 1.2, 0.3\n"
        "04:00:00, 0.1, 1.2, 0.3\n"
        "04:30:00, 0.1, 1.2, 0.3\n"
        "05:00:00, 0.1, 1.2, 0.3\n"
        "05:30:00, 0.1, 1.2, 0.3\n"
        "06:00:00, 0.1, 1.2, 0.3\n"
        "06:30:00, 0.1, 1.2, 0.3\n"
        "07:00:00, 0.1, 1.2, 0.3\n"
        "07:30:00, 0.1, 1.2, 0.3\n"
        "08:00:00, 0.1, 1.2, 0.3\n"
        "08:30:00, 0.1, 1.2, 0.3\n"
        "09:00:00, 0.1, 1.2, 0.3\n"
        "09:30:00, 0.1, 1.2, 0.3\n"
        "10:00:00, 0.1, 1.2, 0.3\n"
        "10:30:00, 0.1, 1.2, 0.3\n"
        "11:00:00, 0.1, 1.2, 0.3\n"
        "11:30:00, 10.2, 1.2, 11.2\n"
        "12:00:00, 0.1, 1.2, 0.3\n"
        "12:30:00, 1.1, 1.2, 0.3\n"
        "13:00:00, 12.1, 1.2, 0.3\n"
        "13:30:00, 0.1, 1.2, 0.3\n"
        "14:00:00, 0.1, 1.2.4, 0.3\n"
        "14:30:00, 23.1, 1.2, 0.3\n"
        "15:00:00, 0.3, 1.2, 0.3\n"
        "15:30:00, 0.1, 1.2, 0.3\n"
        "16:00:00, 0.1, 1.2, 0.3\n"
        "16:30:00, 0.1, 1.2, 0.3\n"
        "17:00:00, 0.1, 1.2, 0.3\n"
        "17:30:00, 0.1, 1.2, 0.3\n"
        "18:00:00, 0.1, 1.2, 0.3\n"
        "18:30:00, 0.1, 1.2, 0.3\n"
        "19:00:00, 0.1, 1.2, 0.3\n"
        "19:30:00, 0.1, 1.2, 0.3\n"
        "20:00:00, 0.1, 1.2, 0.3\n"
        "20:30:00, 0.1, 1.2, 0.3\n"
        "21:00:00, 0.1, 1.2, 0.3\n"
        "21:30:00, 0.1, 1.2, 0.3\n"
        "22:00:00, 0.1, 1.2, 0.3\n"
        "22:30:00, 0.1, 1.2, 0.3\n"
        "23:00:00, 0.1, 1.2, 0.3\n"
        "23:30:00, 10.2, 1.2, 11.2"
    )

    return create_file(csv_data)
